# EMS Parity Matrix

Source of truth used:

- `DEV_ASSETS/master_prompt.txt`
- `DEV_ASSETS/database/extracted/database.sqlite`
- `DEV_ASSETS/database/migrations_inventory.txt`
- `DEV_ASSETS/database/schema_inventory.md`
- screenshots and brandbook assets in `DEV_ASSETS`

| Feature                        | Source Evidence                                                                                   | Target Files                                                                                                                                                                                                                                                                                            | Status |
| ------------------------------ | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| Authentication + Security      | `users` table includes status/2FA fields; migration `add_two_factor_columns_to_users_table`       | `backend/app/Http/Controllers/Api/AuthController.php`, `backend/app/Http/Controllers/Api/TwoFactorController.php`, `backend/app/Models/User.php`, `backend/app/Models/ApiToken.php`, `frontend/src/app/auth/login/page.tsx`, `frontend/src/app/auth/2fa/page.tsx`, `frontend/src/app/settings/page.tsx` | done   |
| Auth Recovery & Verification   | prompt auth requirements include reset password/email verification/profile/password settings      | `backend/app/Http/Controllers/Api/AuthController.php`, `backend/routes/api.php`                                                                                                                                                                                                                         | done   |
| RBAC / Access Control          | `users.role` values + prompt roles                                                                | `backend/app/Http/Middleware/EnsureRole.php`, `backend/routes/api.php`, `frontend/src/components/ems-shell.tsx`                                                                                                                                                                                         | done   |
| Plants Domain + V2 Proxy       | `plants`, `plant_events`, `plant_name_mappings`, `user_plant_assignments`; prompt V2 endpoints    | `backend/app/Http/Controllers/Api/PlantController.php`, `backend/app/Services/V2PlantApiClient.php`, `backend/config/plants.php`, `frontend/src/app/plants/page.tsx`, `frontend/src/app/plants/[uid]/page.tsx`                                                                                          | done   |
| Charts & Data Views            | prompt chart list + screenshot set                                                                | `frontend/src/components/plant-charts.tsx`, `frontend/src/app/plants/page.tsx`, `frontend/src/app/reports/page.tsx`                                                                                                                                                                                     | done   |
| Diagrams (SCADA + JSON)        | `scada_diagrams`, `json_diagrams` tables                                                          | `backend/app/Http/Controllers/Api/DiagramController.php`, `backend/routes/api.php`, `frontend/src/app/diagrams/page.tsx`                                                                                                                                                                                | done   |
| Reports & Exports              | `email_jobs`, report/wysiwyg template tables                                                      | `backend/app/Http/Controllers/Api/ReportController.php`, `frontend/src/app/reports/page.tsx`                                                                                                                                                                                                            | done   |
| Email Templates + Assignments  | `report_email_templates`, `wysiwyg_email_templates`, assignment tables                            | `backend/app/Models/ReportEmailTemplate.php`, `backend/app/Models/WysiwygEmailTemplate.php`, `backend/app/Http/Controllers/Api/ReportController.php`                                                                                                                                                    | done   |
| Customers & Assignments        | `customers`, `customer_plant`                                                                     | `backend/app/Http/Controllers/Api/CustomerController.php`, `backend/app/Http/Controllers/Api/CustomerAssignmentController.php`, `backend/app/Models/Customer.php`, `frontend/src/app/staff/customers/page.tsx`                                                                                          | done   |
| Rekvizitai Enrichment Workflow | prompt external integration requirements + customer schema fields (`rekvizitai_url`, scrape cols) | `backend/app/Http/Controllers/Api/CustomerController.php`, `backend/routes/api.php`, `frontend/src/app/staff/customers/page.tsx`                                                                                                                                                                        | done   |
| User-Plant Assignment Workflow | `user_plant_assignments` + approval fields                                                        | `backend/app/Http/Controllers/Api/UserPlantController.php`, `backend/app/Models/UserPlant.php`, `frontend/src/app/admin/user-plants/page.tsx`                                                                                                                                                           | done   |
| Admin Analytics & Activity     | `user_activities`, `queue_job_logs`, screenshot admin activity                                    | `backend/app/Http/Controllers/Api/AdminController.php`, `frontend/src/app/admin/activity/page.tsx`, `frontend/src/app/admin/analytics/page.tsx`, `frontend/src/app/admin/queue/page.tsx`                                                                                                                | done   |
| Users/Staff Support Endpoints  | route parity expectation includes users/staff support endpoints                                   | `backend/app/Http/Controllers/Api/AdminController.php`, `backend/routes/api.php`, `frontend/src/app/admin/users/page.tsx`                                                                                                                                                                               | done   |
| Translations / i18n            | `translations` table                                                                              | `backend/app/Http/Controllers/Api/TranslationController.php`                                                                                                                                                                                                                                            | done   |
| Queue Monitoring               | `jobs`, `failed_jobs`, `queue_job_logs`                                                           | `backend/app/Http/Controllers/Api/AdminController.php`, `backend/app/Jobs/QueueWatchdogJob.php`                                                                                                                                                                                                         | done   |
| Database Backup System         | `backup_settings` table + migrations                                                              | `backend/app/Http/Controllers/Api/BackupController.php`, `backend/app/Jobs/RunBackupJob.php`, `frontend/src/app/settings/page.tsx`                                                                                                                                                                      | done   |
| Documentation System           | `documentations`, pivots tables                                                                   | `backend/app/Http/Controllers/Api/DocumentationController.php`, `backend/app/Models/Documentation.php`, `frontend/src/app/docs/page.tsx`, `frontend/src/app/admin/docs/page.tsx`, `frontend/src/app/admin/api-docs/page.tsx`                                                                            | done   |

## Notes

- Because no full runtime source tree was provided (only DB backup + asset references), implementation is reconstructed from schema/migrations and explicit prompt requirements.
- Matrix will be updated as more source runtime files (routes/controllers/pages) become available.
